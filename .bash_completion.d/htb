# alias htb=""
# TODO HOST not define display error

_htb()
{
    local cur=${COMP_WORDS[COMP_CWORD]}
    local prev=${COMP_WORDS[COMP_CWORD-1]}

    local WORD_LIST=()
    if [ "$prev" == "htb" ]; then
        WORD_LIST+=("nmap -sC -sV -o nmap ${RHOST}")
        WORD_LIST+=("vim /etc/hosts")
        WORD_LIST+=("gobuster dir")
        WORD_LIST+=("gobuster vhost")
        WORD_LIST+=(wfuzz hashcat)
        WORD_LIST+=("ssh ${RUSER}@${RHOST} -i")
            # TODO autocomplete with filenames
        WORD_LIST+=("snmpwalk -v2c -c public ${RHOST} . | tee snmp.output")
    elif [ "$prev" == "gobuster" ]; then
        WORD_LIST+=("dir -u http://${RHOST} -w ~/software/SecLists/Discovery/Web-Content/raft-medium-words-lowercase.txt -x php | tee gobuster.log")
        WORD_LIST+=("vhost -u ${RHOST} -w ~/software/SecLists/Discovery/DNS/bitquark-subdomains-top100000.txt | tee gobuster.vhost.log")
    elif [ "$prev" == "-i" ]; then
        # list files for ssh key
        WORD_LIST+=($(ls))
    fi

    if [[ -z "$RHOST" ]]; then
        WORD_LIST+=("----RHOST not set----")
    fi

    local IFS=$'\n'
    COMPREPLY=( $(compgen -W "${WORD_LIST[*]}" -- $cur) )
    unset IFS
    
    # echo "| ${prev} |"
}
complete -F _htb htb


# -o filenames to To auto complete file paths
# complete -o filenames -F __my_app_autocomplete my_app
# https://stackoverflow.com/questions/44441249/how-to-autocomplete-a-bash-commandline-with-file-paths

# https://tuzz.tech/blog/adding-bash-completion
# $COMP_LINE contains the full line that was typed, 
# $COMP_WORDS is that same line broken into an array of words and 
# $COMP_POINT is the cursorâ€™s index position.
